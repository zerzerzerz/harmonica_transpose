# 口琴谱调号转换器 (Harmonica Transpoter)

这是一个用于口琴简谱调号转换的 Python 工具。它可以将一份以某个调（如 C 调）标记的谱子，转换为另一个调（如 D 调）的记谱方式，同时保持实际发音高度不变。

## 功能特点

- **多调性支持**：支持 C, C#, Db, D, Eb, E, F, F#, G, Ab, A, Bb, B 等所有常见调号。
- **符号解析**：
    - `#1` ~ `#7`：升半音。
    - `b1` / `♭1`：降半音。
    - `(1)` / `（1）`：低八度标记（支持中英文括号自动识别）。
    - `[1]` / `【1】`：高八度标记（支持中英文括号自动识别）。
- **智能记谱转换**：核心逻辑为“重标记法”，即保持音高不变，根据目标调号重新计算每个音阶的名称。
- **文件与控制台输出**：支持直接在控制台打印结果，或将结果保存到指定文件。

## 安装

无需安装，只需确保您的系统中安装了 Python 3。

```bash
# 克隆或下载脚本后直接运行
python harmonica_transpose.py --help
```

## 使用方法

### 基础用法

将 C 调谱子转换为 D 调并在屏幕显示：

```bash
python harmonica_transpose.py -i input.txt --target D
```

### 保存到文件

使用 `-o` 参数指定输出文件：

```bash
python harmonica_transpose.py -i input.txt --target G -o output.txt
```

### 指定源调号

如果你的原始谱子不是 C 调，可以使用 `--source` 或 `-s` 参数：

```bash
# 将 D 调谱子转换为 G 调
python harmonica_transpose.py -i input.txt --target G --source D
```

### 参数说明

| 参数       | 缩写 | 描述         | 备注                                   |
| :--------- | :--- | :----------- | :------------------------------------- |
| `--input`  | `-i` | 输入内容     | 可以是文件路径，也可以是直接的谱子文本 |
| `--target` |      | 目标调号     | 如 D, F#, Bb (必填)                    |
| `--source` | `-s` | 源调号       | 默认为 C                               |
| `--output` | `-o` | 输出文件路径 | 若不指定则打印到屏幕                   |

## 示例

**输入 (C 调):**
`332#4 (6)2335#4`

**命令:**
`python harmonica_transpose.py -i "332#4 (6)2335#4" --target D`

**输出 (D 调):**
`2213 (5)12243`

## 注意事项

此程序会递归处理括弧嵌套。非音符字符（如空格、换行、重复符号等）将完整保留。
